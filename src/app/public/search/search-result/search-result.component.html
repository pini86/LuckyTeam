@if (searchRoutes(); as model) {
  <div class="wrapper container">
    <div class="title">
      <span class="title__date">
      {{ searchRoutes().from.city }}
        <mat-icon class="arrow-icon">arrow_forward</mat-icon>
        {{ searchRoutes().to.city }}</span>
      @if (_startDate().length) {
        {{ _selectedStartDate() |  transformDateIsoToMonth }}, {{ _selectedStartDate() |  transformDateIsoToDay }}
      } @else {
        <span class="title__error">No routes found</span>
      }
    </div>

    @if (_startDate().length) {


      <mat-tab-group [(selectedIndex)]="_selectedTabIndex" (selectedIndexChange)="_onTabChange($event)">


        @for (date of _startDate(); track date) {
          <mat-tab>
            <ng-template mat-tab-label class="card-date">

              <div class="card-date__title">
                <span>{{ date | transformDateIsoToMonth }} </span> <span>{{ date | transformDateIsoToDay }}</span>
              </div>
              <span class="card-date__week"> {{ date | transformDateIsoToWeek }}</span>
            </ng-template>

            <div class="wrapper-content">


              @for (ride of _rideModelRoutesSelectedDate(); track ride) {

                <mat-card appearance="outlined" class="card" (click)="_handleClickCard(ride.routeId)">
                  <mat-card-content>

                    <div class="content">
                      <div class="ride-data">
                        <div class="ride-data__header">
                          <div class="ride-data__date-info">
                            <span class="ride-data__time">{{ ride.dateFrom | transformDateIsoToTime }}</span>
                            <span class="ride-data__date">
                            <span>{{ ride.dateFrom | transformDateIsoToMonth }} </span>
                            <span>{{ ride.dateFrom | transformDateIsoToDay }}</span>
                          </span>
                            <span class="ride-data__station">{{ searchRoutes().from.city }}</span>
                          </div>
                          <div class="ride-data__between">
                            <div class="ride-data__between-time">{{ ride.dateFrom | travelTime: ride.dateTo }}</div>
                            <span class="ride-data__separator"></span>
                          </div>
                          <div class="ride-data__date-info">
                            <span class="ride-data__time">{{ ride.dateTo | transformDateIsoToTime }}</span>
                            <span class="ride-data__date">
                            <span>{{ ride.dateTo | transformDateIsoToMonth }} </span>
                            <span>{{ ride.dateTo | transformDateIsoToDay }}</span>
                          </span>
                            <span class="ride-data__station">{{ searchRoutes().to.city }}</span>
                          </div>
                        </div>

                        <div class="ride-data__footer">
                          <div class="ride-data__route">
                            <mat-icon class="tram-icon">tram</mat-icon>
                            <div class="ride-data__route-info">
                              @if (_cities().length) {
                                <div>{{ ride.path[0] | transformRideCity: _cities() }}
                                  <mat-icon class="arrow-icon">arrow_forward</mat-icon>
                                  {{ ride.path[ride.path.length - 1] | transformRideCity: _cities() }}
                                </div>
                              }
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="carriage-data">
                        @for (car of ride.price | keyvalue; track car) {
                          <div class="carriage-data__price">
                            <span class="carriage-data__type">{{ car.key }}:</span>
                            <span class="carriage-data__value">{{ car.value }}</span>
                          </div>
                        }
                      </div>
                    </div>
                  </mat-card-content>
                </mat-card>
              }

            </div>

          </mat-tab>
        }


      </mat-tab-group>
    }


  </div>
}


